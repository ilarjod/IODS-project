#Regression and model validation

*This week I learned about importing and wrangling data and simple analysis*



## Importing data
```{r warning=FALSE, message=FALSE}
library(dplyr)
library(ggplot2)
library(GGally)
lrn14 <- read.table("data/learning2014.txt")
dim (lrn14)
str(lrn14)
summary(lrn14)
``` 

I originally imported a dataset with 183 observations and 66 variables and manipulated it as advised into a tighter one, which I will be analysing now.

It now contains 166 observations and 7 variables.

```{r warning=FALSE, message=FALSE}
summary(lrn14$gender)
summary(lrn14$age)
summary(lrn14$attitude)
summary(lrn14$deep)
summary(lrn14$stra)
summary(lrn14$surf)
summary(lrn14$points)
```
 


## Graphical overview
```{r warning=FALSE, message=FALSE}
p <- ggpairs(lrn14, mapping = aes(col = gender, alpha = 0.3), lower = list(combo = wrap("facethist", bins = 20)))
p
```






## Fitting a regression model

Let's try to model `points ` with 3 variables. I choose `age`, `attitude` and `stra`.

```{r warning=FALSE, message=FALSE}
model1 <- lm(points ~ age + attitude + stra, data = lrn14)
summary(model1)
```

Only `attitude`  seems to be correlated enough (other are P<0.1, attitude p<0.001), so let's dump the other two from the model.

```{r warning=FALSE, message=FALSE}
model2 <- lm(points ~ attitude , data = lrn14)
summary(model2)
```

Attitude is a statistically significant variable. 

Let's visualize the model.

```{r warning=FALSE, message=FALSE}
qplot(attitude, points, data = lrn14) + geom_smooth(method = "lm")
```




## Model diagnostics
```{r warning=FALSE, message=FALSE}
par(mfrow = c(2,2))
plot(model2, which = c(1,2,5)) 
```

Our model seems to be valid.

## Conclusion

Positive attitude gives you more points!

